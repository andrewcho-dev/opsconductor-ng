name: asset_search
display_name: Asset Search
description: Search and list assets in inventory matching filters
category: asset
platform: cross-platform
version: 1.0.0
source: local

command_template: |
  python3 -c "
  import sys
  import json
  import httpx
  
  # Parse parameters
  filters = {}
  if '{os}':
      filters['os'] = '{os}'
  if '{hostname}':
      filters['hostname'] = '{hostname}'
  if '{ip}':
      filters['ip'] = '{ip}'
  if '{status}':
      filters['status'] = '{status}'
  if '{environment}':
      filters['environment'] = '{environment}'
  
  limit = {limit}
  
  try:
      # Call asset fa√ßade API
      base_url = 'http://automation-service:3003'
      params = {{k: v for k, v in filters.items() if v}}
      params['limit'] = limit
      
      response = httpx.get(f'{{base_url}}/assets/search', params=params, timeout=10.0)
      response.raise_for_status()
      
      result = response.json()
      print(json.dumps(result, indent=2))
      sys.exit(0)
      
  except Exception as e:
      print(json.dumps({{'error': str(e), 'success': False}}))
      sys.exit(1)
  "

timeout_seconds: 15
requires_admin: false

parameters:
  - name: os
    type: string
    description: OS type or version filter (e.g., "Windows 10", "linux")
    required: false
    default: ""
  
  - name: hostname
    type: string
    description: Hostname filter (partial match supported)
    required: false
    default: ""
  
  - name: ip
    type: string
    description: IP address filter (exact match)
    required: false
    default: ""
    pattern: "^(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})?$"
  
  - name: status
    type: string
    description: Status filter
    required: false
    default: ""
    enum: ["", "active", "inactive", "maintenance"]
  
  - name: environment
    type: string
    description: Environment filter
    required: false
    default: ""
    enum: ["", "production", "staging", "development", "test"]
  
  - name: limit
    type: integer
    description: Maximum number of results to return
    required: false
    default: 50
    min_value: 1
    max_value: 500

max_output_bytes: 65536
redact_patterns: []

tags:
  - asset
  - inventory
  - search
  - list
  - query

examples:
  - description: "List all Windows 10 machines"
    parameters:
      os: "Windows 10"
      limit: 50
  
  - description: "Find production Linux servers"
    parameters:
      os: "linux"
      environment: "production"
      limit: 100
  
  - description: "Search by hostname"
    parameters:
      hostname: "web-server"